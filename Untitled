# 解釋

這裡包含了一些基礎的權限管理解釋，還有你為何會需要它，

然後如果你看完了之後發現你並不需要，請向時間銀行要求索賠吧。

&nbsp;

## 我為什麼需要它？

一個沒有權限管理系統的網站是**很恐怖**的，

我的意思是，就算你有分階層*（例如：訪客、使用者、管理員）*，

這樣看起來雖然沒什麼，但當你需要人手來管理網站的時候，**你會賦予他們「管理員」的權限**，

好死不死，「管理員」就是網站中**最大的權限**，甚至可以把**整個網站關機**，

設想看看，今天一個 22K 的上班族，**隨時都可以把你的網站關閉**，不覺得很恐怖麼？

這就是為什麼**你應該採用權限管理系統**，額外新增一個「版主」來管理網站，

如此一來，他們就**沒辦法**碰到系統深層的功能，當然，

你**也可以**不使用權限管理系統來新增「版主」，但是日復一日，

**你可能會有更多的階級**，這個時候，你就沒辦法不使用權限管理系統，

除非**你希望每次有新的階級，就更新一次程式碼**。

&nbsp;

## RBAC、ACL、DAC？

管理權限系統分成很多類，連我也不是很明白（沒錯。）

讓我們先談談 **RBAC（Role-Based Access Control）**，下面是你使用 RBAC 會遇見的情況：

```php
if($this->hasRole('管理員') || $this->hasRole('版主') $this->hasRole('使用者'))
{
    ... 程式 ...
}
```

發現了嗎？RBAC 想知道的，**不是你可以做什麼**，而是**你是誰**。

&nbsp;

接下來談談 **ACL （Access Control List）**，說到這裡，ACL 感覺簡單多了。

```php
if($this->can('編輯', '文章'))
{
    ... 程式 ...
}
```

ACL 詢問的是：**你有權力這樣做嗎**？而**不在乎你是誰**（也許還是會在乎一下啦）。

&nbsp;

然後是 **DAC（Discretionary Access Control）**，假設這樣好了，你**不能**編輯 `檔案A` 但是 小明 可以。

那麼你就可以要求 小明 將這個權限新增給你，接著你有了編輯權限後，**你也可以新增給其他人**，讓其他人有權限來編輯這個檔案。

&nbsp;

總而言之：

> RBAC：詢問「你是誰」？

> ACL：詢問「你可以做這件事」嗎？

> DAC：你可以新增給別人相同的權限。

&nbsp;

## 帝國包含什麼？

所以帝國算是 RBAC 或是 ACL 或是 DAC？

我也不清楚，也許他是另一種架構，如果真的是這樣，那個時候，

*我一定要把我的名字加在這個架構裡。*

&nbsp;

那麼，帝國包含什麼？帝國是基於動作的權限管理系統（大部分使用的時候像是 ACL），

在帝國中，你通常會想詢問使用者「能不能幹嘛」。

但是帝國有個更龐大，更複雜的構想，那就是角色和組織系統，甚至還有資源系統。

&nbsp;

### 角色和組織系統？

你可以建立一個角色，例如「版主」，然後配予他一個「編輯」的權限，

然後**別忘記**，一個使用者可以擁有多個角色，我想這對你來說這應該好理解。

&nbsp;

但是今天加上了組織系統，**你的角色就必須要有組織**，這樣說好了，你可能想做一個線上約砲網站，

然後還可以自己在網站內開一個新的群組，

你還希望這個群組中擁有自訂階級的功能，例如：*管理員*、*版主*、*一般人*。

這個時候組織系統就派上用場了，什麼意思？我的意思是：

> 假設 *小明* 是約砲網站的使用者，然後**他建立了一個專門聊色的群組**

那麼他就有**兩種身分和兩個組織**：

> 分別是位於**「網站」組織中的「使用者」身分**，還有**「聊色群組」組織中的「管理員」身分**。

不覺得這樣很好嗎？**你就不用在替群組功能新增一個額外的身分功能啦**。

&nbsp;

### 資源系統？

有了組織系統，仍然不能滿足一些人，設想看看，假設你有這個問題：

> 而版主可以移除任何使用者的文章。

> 管理員發布了一篇文章。

什麼問題發生了？**版主可以刪除管理員的文章**。

RBAC 和 ACL 並**不能**夠讓你做到「版主」無法刪除「管理員」所發布的文章，

因為他們**只在乎**「你能不能刪除文章」這個動作，一但他們可以刪除，**那就是任何文章都可以**。

&nbsp;

帝國的出現，就是想要使用在這種情況：

> 版主 可以刪除所有文章，**但是** 管理員 的不行。

> 版主 可以刪除所有文章，**但是** 編號 3 的文章就是不行。

同樣的，RBAC 和 ACL **都沒辦法**做到指定特別組織，或是特別角色，甚至特別文章。

而帝國想要特別針對這一點做出改進，我們將特別的對象稱之為資源。

&nbsp;